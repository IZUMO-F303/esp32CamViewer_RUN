# ESP32-CAM Webビューア & モーターコントローラー

## 1. 概要

このプロジェクトは、ESP32-CAMを使用してWi-Fi経由でビデオストリーミングを行い、Webブラウザからカメラ映像の確認と、接続されたモーター等のGPIO制御を可能にするものです。
動画でも紹介しています。
https://youtu.be/uA07fqSSEcQ

## 2. 主な機能

- **ビデオストリーミング:** Webブラウザ上でリアルタイムにカメラ映像を表示します。
- **カメラコントロール:** 解像度、画質、明るさなど、様々なカメラパラメータをWeb UIからリアルタイムに調整できます。
- **GPIO/モーター制御:**
    - **D-pad:** Web UI上の方向キー（FORWARD, BACK, LEFT, RIGHT, STOP）により、直感的なモーター操作が可能です。
    - **SPDスライダー:** モーターの速度（PWMデューティ比）を一括で調整します。
    - **Trimスライダー:** 直進・後進時の左右のモーターバランスを微調整し、直進性を補正します。
    - **個別GPIO制御:** GPIO12, 13, 14, 15のON/OFFとデューティ比を個別に設定できます。
- **断続的なPWM駆動:** モーターは25msのPWM出力と25msの停止を繰り返す周期（20Hz）で駆動されます。

## 3. ハードウェア構成

- **必須:** ESP32-CAM ボード (例: AI-THINKERモデル)
- **任意:** モータードライバー、モーター、ロボットカーの車体など
- **GPIO割り当て:**
    - 右モーター: GPIO12, GPIO14
    - 左モーター: GPIO13, GPIO15
    - カメラのピン配置は `include/camera_pins.h` に定義されています。使用するボードに合わせて確認・変更してください。

## 4. セットアップと使用方法

### 4.1. ソースコードの編集

`src/main.cpp` ファイルを開き、ご自身のWi-Fi環境に合わせてSSIDとパスワードを編集します。

```cpp
// Wi-Fi credentials
const char* ssid = "YOUR_WIFI_SSID";
const char* password = "YOUR_WIFI_PASSWORD";
```

### 4.2. ビルドとアップロード

1.  PlatformIO環境でこのプロジェクトを開きます。
2.  PlatformIOの機能を使用して、プロジェクトをビルドし、ESP32-CAMにファームウェアをアップロードします。

### 4.3. 操作方法

1.  アップロード後、PlatformIOのシリアルモニターを起動します（ボーレート: 115200）。
2.  ESP32-CAMがWi-Fiに接続すると、シリアルモニターにIPアドレスが表示されます。
    ```
    WiFi connected
    Camera Ready! Use 'http://192.168.X.X' to connect
    ```
3.  同じWi-Fiネットワークに接続されたPCやスマートフォンのWebブラウザで、表示されたIPアドレス（例: `http://192.168.X.X`）にアクセスします。
4.  表示されたWeb UIで、カメラ映像の確認とモーターの操作を行います。

## 5. 主要ファイル構成

- `src/main.cpp`: メインプログラム。Wi-Fi接続、カメラ初期化、モーター制御ループ（`loop`関数）を記述。
- `src/app_httpd.cpp`: Webサーバーのバックエンド処理。HTTPリクエストに応じて、カメラ制御やGPIO制御を行います。
- `index_ov2640.html`: Webブラウザに表示されるユーザーインターフェース。
- `include/pwm_control.h`: PWM制御に関する状態変数を共有するためのヘッダーファイル。
- `include/camera_pins.h`: ESP32ボードとカメラモジュール間のピン接続を定義するヘッダーファイル。
- `platformio.ini`: PlatformIOのプロジェクト設定ファイル（ビルド環境、ライブラリ依存関係など）。
- `esp32CAMrover_Run_circuit`: 回路図
